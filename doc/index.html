<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>nametake</title>
<link rel="stylesheet" href="./style.css"/>
<!--<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>-->
<script src="./jquery.1.6.js"></script>
<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/jquery-ui.min.js"></script>
<script src="../jquery.nametake.js"></script>
<script src="../preloader.js"></script>
<script src="./site.js"></script>
</head>
<body>
<ul id="navigation">
  <li class="main">
    <p><a href="./#!/about">なめたけ</a></p>
    <ul>
      <li><a href="./#!/about/concept">コンセプト</a></li>
      <li><a href="./#!/about/download">ダウンロード</a></li>
    </ul>
  </li>
  <li class="main">
    <p><a href="./#!/howto">使い方</a></p>
    <ul>
      <li><a href="./#!/howto/initialize">起動</a></li>
      <li><a href="./#!/howto/scene">画面遷移</a></li>
      <li><a href="./#!/howto/preloader">プリローダ</a></li>
      <li><a href="./#!/howto/options">その他もろもろ</a></li>
    </ul>
  </li>
</ul> 
<div id="pages">
  <div data-page-id="about" class="page parent" id="about">
    <div class="content">
      <h2>なめたけ</h2>
      <p>なめたけ(nametake)は、リッチなWebサイトを手早く、きれいに制作するためのシンプルなフレームワークです。jQueryのプラグインとして動作します。名前の由来は特にありません。</p>
      <p class="image"><img src="./fig_nametake.gif" width="200" height="200" /></p>
    </div>
    <div data-page-id="concept" class="page content">
      <h2>コンセプト</h2>
      <p>
      <p>とりわけ、画面遷移を抽象化。あくまでサイト全体の枠組みを整えるので、</p>
    </div>
    <div data-page-id="download" class="page content">
      <h2>ダウンロード</h2>
      <p>githubにてソースコードを公開しています。</p>
    </div>
  </div>
  <div data-page-id="howto" class="page parent clearfix" id="howto">
    <div class="content">
      <h2>使い方</h2>
      <p>nametakeの構成はいたってシンプルです。</p>
      <dl>
        <dt><a href="">画面遷移</a></dt>
        <dd>nametakeの根幹をなす部分</dd>
        <dt><a href="">プリローダ</a></dt>
        <dd>flashサイトにあるようなプリローダが使えます</dd>
        <dt><a href="">その他のこと</a></dt>
        <dd>起動時に設定可能なオプションの話と、その他のこまごまとしたこと</dd>
      </ul>
    </div>
    <div data-page-id="initialize" class="page content">
    </div>
    <div data-page-id="scene" class="page content">
      <h2>画面遷移の制御</h2>
      <p>Webサイトは多くの場合複数の画面から構成されており、ユーザーからの入力において画面が遷移します。

      <p>nametakeは1つ1つの画面をSceneオブジェクトとして管理しています。それぞれのSceneは固有のIDを持っており、ManagerオブジェクトのmoveTo</p>

      <p>nametakeでは、サイト、それぞれのDOM要素に対応するSceneオブジェクトを、data-page-id、またdata-page-url属性を指定すると、URLを自動的にロードします。

      <h3></h3>
      <p>nametakeを起動すると、DOMツリーからクラス名としてpageという名前をつけた要素のみを抽出し、それらの階層関係を反映する形でSceneの構造
であるとみなされます。この際、DOMの階層構造がそのまま反映されるため、したがって完成する階層構造をもったScene。たとえば</p>

      <h3>画面遷移の演出</h3>
      <p>シーンの移動にともなう実際の演出はどこに書けばよいのでしょう？　Sceneオブジェクトには、start, end, toといったメソッドが用意されており、これらにコールバック関数を渡すことで、「どこから」「どこへ」移動したときに「どんな」演出を加えたらよいのか、といった情報を登録することができます。</p>
      <div class="quote">
        <pre>
manager.of('page1', function(scene) {
  scene
    .start(function(next) {
      $(scene.element).fadeOut();
    })
    .end(function(next) {
    })
    .to('page2', function(next) {
    });
});</pre>
        <p class="caption">演出の登録</p>
      </div>
      <p>上記の例からもわかるように、nametakeは「どんな演出をするか=DOM要素をどのように動かすか」については一切関与しません。nametakeが管理するのは、現在表示されているシーンの情報や、画面遷移の開始と終了のタイミングだけです。したがって、実際に行なうDOM操作の内容はユーザー側が自由に指定することができます。Sceneオブジェクトのelementプロパティから対応するDOM要素を参照できるので、多くの場合これを操作することになるでしょう。</p>
      <h3>遷移の伝播について</h3>
      <p>シーンの移動は、前述したツリーのグラフの辺に沿って順次発生します。たとえば、シーン/parent1/child2からシーン/parent2/child1への移動は</p>
      <ol>
        <li>/parent1/child2 → /parent1l</li>
        <li>/parent1 → /parent2</li>
        <li>/parent2 → /parent2/child1</li>
      </ol>
      <p>という3つのステップを経ることになります。このとき、対応するコールバック関数として</p>
      <ol>
        <li>/parent1/child2のstartメソッドで登録したコールバック</li>
        <li>/parent1/child2のtoメソッドで登録したコールバック</li>
        <li>/parent1のtoメソッドで登録したコールバック</li>
        <li>/parent2のtoメソッドで登録したコールバック</li>
        <li>/parent2/child1のendメソッドで登録したコールバック</li>
      </ol>
      <p>が順次実行されます。</p>
    </div>
    <div data-page-id="preloader" class="page content">
      <h2>プリローダ</h2>
      <p>nametakeにはプリローダが添付されています。data-page-urlで指定した外部html、imgタグの中身や、スタイルシート中のbackground-imageを先読みし、全ての画像やページのロードが終わると、completeイベントに登録されたコールバック関数が実行されます。</p>
      <p>ローディング中は一定間隔でprogressイベントが発行されるので、コールバック関数内で毎回の進捗状況を更新できます。下記の例ではPreloader#getProportion()メソッドを使ってローディングの割合を描画しています。</p>
      <pre>
manager.on('preinitialize', function(preloader) {
  preloader.on('progress', function() {
    $('#preloader').text(Math.ceil(preloader.getProportion() + '%'));
  });

  preloader.on('complete', function() {
    manager.initialize(); //サイト本体の起動
  });
});
</pre>
      <div class="footerNavi">
        <p class="prev"><a href="./#!/howto/scene">&lt;&lt;画面遷移</a></p>
        <p class="next"><a href="./#!/howto/options">&gt;&gt;その他のこと</a></p>
      </div>
    </div>
    <div data-page-id="options" class="page content">
      <h2>page2-3</h2>
    </div>
  </div>
</div>
</body>
</html>
